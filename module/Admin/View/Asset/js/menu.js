"use strict";var mainMenu=document.querySelector("ul.list-group.sortable"),addMenuItem=document.getElementById("menu-add-item"),addMenuItemBlank=document.getElementById("menu-item-blank");function editMenuItems(){var e=JSON.stringify(formatMenuItems(getMenuItems(mainMenu))),t=document.querySelector(".spinner-action"),n=(t.classList.add("spinner-action_active"),new FormData);n.set("items",e),n.set(SETTING.csrf.key,SETTING.csrf.token),fetch(t.getAttribute("data-menu-action"),{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){SETTING.toast(e.status,e.message)}).catch(function(e){SETTING.toast("error",e)}).finally(function(){t.classList.remove("spinner-action_active")})}function getMenuItems(u){var a=[];return u.querySelectorAll(".menu-list").forEach(function(e){var t={name:"#",url:"#",parent:null,children:[]},n=e.closest("ul.list-group.sortable");n!==u&&(t.parent=getItemProp(n.previousElementSibling,"name")),t.name=getItemProp(e,"name"),t.url=getItemProp(e,"url"),a.push(t)}),a}function formatMenuItems(){for(var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n={},u=[],a=0;a<t.length;a+=1)t[n[t[a].name]=a].children=[];for(a=0;a<t.length;a+=1)((e=t[a]).parent?t[n[e.parent]].children:u).push(e);return u}function getItemProp(e){var t;switch(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"name"){case"name":return null!=(t=null==(t=e.querySelector('.menu-item > input[name="name"]'))?void 0:t.value)?t:"";case"url":return null!=(t=null==(t=e.querySelector('.menu-item > input[name="url"]'))?void 0:t.value)?t:"";default:return null}}null!=addMenuItem&&addMenuItem.addEventListener("click",function(e){e.preventDefault();e=addMenuItemBlank.cloneNode(!0);e.classList.remove("hidden"),e.removeAttribute("id"),mainMenu.appendChild(e),makeSortable(e.querySelector(".sortable"))}),document.addEventListener("click",function(e){var t=e.target.closest(".menu-item__icon");t&&t.classList.contains("feather-trash")&&fadeOut(t.closest(".menu-list"),!1,"editMenuItems"),(e.target.closest("[data-bs-toggle]")||e.target.closest("[data-bs-toggle]"))&&e.preventDefault()}),document.addEventListener("focusout",function(e){e.target.classList.contains("menu-item__input")&&editMenuItems()});